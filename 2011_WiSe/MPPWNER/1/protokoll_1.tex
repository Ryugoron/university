\documentclass[11pt,a4paper,ngerman]{article}
\usepackage[bottom=2.5cm,top=2.5cm]{geometry} 
\usepackage{babel}
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc} 
\usepackage{ae} 
\usepackage{amssymb} 
\usepackage{amsmath} 
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{fancyref}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{paralist}
\usepackage{fancyhdr}
\usepackage{subfigure}
\pagestyle{fancy}
\fancyhead[C]{Mikroprozessorpraktikum}
\fancyhead[L]{Protokoll 1}
\fancyhead[R]{WS 2011/12}
\fancyfoot{}
\fancyfoot[L]{}
\fancyfoot[C]{\thepage / \pageref{LastPage}}
\renewcommand{\footrulewidth}{0.5pt}
\renewcommand{\headrulewidth}{0.5pt}
\setlength{\parindent}{0pt} 
\setlength{\headheight}{15pt}


\author{Teilnehmer:\\ \\Marco Träger, Matr. XXXXXXXX\\Alexander Steen, Matr. 4357549}
\date{Gruppe: XXX, Arbeitsplatz: XXX}
\title{Mikroprozessorpraktikum WS 2011/12\\ Aufgabenkomplex: 1}

\begin{document}

\lstset{language=c, basicstyle=\ttfamily\fontsize{10pt}{10pt}\selectfont\upshape, commentstyle=\rmfamily\slshape, keywordstyle=\rmfamily\bfseries, breaklines=true, frame=single, xleftmargin=3mm, xrightmargin=3mm, tabsize=2}

\maketitle
\thispagestyle{fancy}
\newpage
\section*{A 1.1 Output}
\subsection*{A 1.1.1}
\subsection*{A 1.1.2}
\subsection*{A 1.1.3}
\subsection*{A 1.1.4}
\subsection*{A 1.1.5}
\subsection*{A 1.1.6}
\section*{A 1.2	Input}
\subsection*{A 1.2.1}
\begin{description}
\item[P1DIR] entscheidet, ob der jeweilige Pin als Eingang oder Ausgang fungiert, dabei beschreibt 0 einen Eingang, 1 einen Ausgang
\item[P1IN] besteht aus einem Byte, deren Bits den aktuellen Logikpegel an dem jeweiligen Pin des Ports 1 darstellen
\item[P1OUT] zeigt an dem jeweiligen Bit an, welcher Logikpegel an dem zugehörigen Port anliegen soll, falls P1DIR auf Ausgang und P1SEL auf I/O-Funktion geschaltet ist
\item[P1SEL] gibt an, ob die einzelnen Pins des Port 1 direkt als I/O benutzt werden (Wert 0) oder für ein angeschlossenes Modul (Wert 1)
\item[P1IE] de-/aktiviert die Intertupt-Flags (P1IFG) für die Pins des ersten Ports.
\item[P1IES] entscheidet, ob man Interrupt durch eine low-high-Flanke (0) oder eine high-low-Flanke (1) auf dem jeweiligen Pin ausgelöst werden soll.
\item[P1IFG] bezeichnet die Interrupt-Flags der Pins von Port 1. Ist ein Bit von P1IFG auf 1 gesetzt, so wurde von dem zugehörigen Pin ein Interrupt ausgelöst.
\end{description}

\subsection*{A 1.2.2}
Der AND-Operator (\&) führt bitweise die Verundung der Bits der Arguments aus.\\
Geht man für das Codebeispiel
\begin{lstlisting}
if (P1IN & Taster) {...}
\end{lstlisting}
davon aus, dass an dem Pin $i$ von Port 1 ein Taster angeschlossen ist, so kann man durch Wahl der Variable \texttt{Taster} als Bitmaske, die nur an der Stelle $i$ eine 1 enthält (\texttt{Taster} = $2^i$), erreichen, dass die Abfrage genau dann erfolgreich ist, falls der Taster gedrückt wurde.
\subsection*{A 1.2.3} 
\begin{lstlisting}[numbers=left]
#define Taster_rechts (0x01)
#define Taster_links (0x02)
P1DIR = 0x00;
P4DIR = 0xFF;
P4OUT = 0;
a = 7;
P4OUT = a;
P1OUT = a;
a = P1IN & 0x30; //beide Tasten gedr.
a = P1IN & 0x00; //Taste rechts gedr.
a = P1IN & 0x01; //Taste rechts gedr.
a = P1IN & 0x02; //Taste rechts gedr.
a = P1IN & 0x03; //Taste links gedr.
a = P1IN & 0x03; //beide Tasten gedr.
P4OUT = P1IN & Taster_rechts; //Taster an P1.0 nicht gedr.
P4OUT = P1IN & Taster_links; //Taster an P1.0 gedr.
\end{lstlisting}
\begin{description}
\item[Zeile 1,2] Definiert Bitmasken, auf welche Bits der Register der rechte bzw. linke Taster zugreift
\item[Zeile 3] Alle Pins von Ports 1 werden auf Eingang geschaltet
\item[Zeile 4] Hier werden nun alle Pins von Ports 4 auf Ausgang geschaltet
\item[Zeile 5] An alle Pins von Port 4 werden die Logikpegel 0 angelegt
\item[Zeile 6] \texttt{a} wird auf 7 gesetzt
\item[Zeile 7] Setzt die unteren drei Bits von \texttt{P4OUT} auf 1. Wenn \texttt{P4SEL} für die unteren drei Pins auf I/O-Funktion gestellt ist, liegt an diesen Pins nun jeweils eine 1 an (die LEDs leuchten nicht).
\item[Zeile 8] Setzt die unteren drei Bits von \texttt{P1OUT} auf 1. Da \texttt{P1DIR} auf Eingang steht, ändert sich nichts.
\item[Zeile 9] Da die beiden Tasten die beiden untersten Bits sind, ist das Ergebnis der Verundung 0, also wird a = 0 gesetzt
\item[Zeile 10] Hier wird mit Und auf 0 ausgeführt, also wird a = 0 gesetzt
\item[Zeile 11] a = 1, da Taster gedrückt
\item[Zeile 12] a = 0, da mit der Bitmaske für den linken Taster verglichen wird
\item[Zeile 13] a = 2, weil der Wert des linken Tasters genommen wird (an der zweiten Stelle in der Maske)
\item[Zeile 14] a = 3, da sowohl der Wert des linken Tasters (2) und des rechten (1) genommen wird
\item[Zeile 15] \texttt{P4OUT} wird auf 0 gesetzt, da kein Taster gedrückt ist
\item[Zeile 16] \texttt{P4OUT} wird auf 0 gesetzt, da die Bitmaske den Tasterwert von P1.0 nicht berücksichtigt
\end{description}
\subsection*{A 1.2.4}

\begin{lstlisting}[numbers=left]
void aufgabe() {
	#define Taster_rechts (0x01)
	#define Taster_links (0x02)
	#define rot (0x01)
	#define gelb (0x02)
	#define gruen (0x04)
	P1SEL = 0x00;
	P1DIR = 0x00;	
	P4SEL = 0x00;
	P4DIR = 0x07;
	
	if (~((P1IN & Taster_rechts) ^ (P1IN & Taster_links))) {
		P4OUT = gelb;
	} else if((P1IN & Taster_rechts) & ~(P1IN & Taster_lins)) {
		P4OUT = gruen;
	} else if(~(P1IN & Taster_rechts) & (P1IN & Taster_lins)) {
		P4OUT = rot;
	}
}
\end{lstlisting}

\section*{A 1.3 Ampel}
\subsection*{A 1.3.1}
\section*{A 1.4 Taster}
\subsection*{A 1.3.1}
\label{LastPage}
\end{document}