\documentclass[11pt,a4paper,ngerman]{article}
\usepackage[bottom=2.5cm,top=2.5cm]{geometry} 
\usepackage{babel}
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc} 
\usepackage{ae} 
\usepackage{amssymb} 
\usepackage{amsmath} 
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{fancyref}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{paralist}

%\usepackage[pdftex, bookmarks=false, pdfstartview={FitH}, linkbordercolor=white]{hyperref}
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead[C]{Semantik von Programmiersprachen}
\fancyhead[L]{Übung Nr. 3}
\fancyhead[R]{SoSe 2012}
\fancyfoot{}
\fancyfoot[L]{}
\fancyfoot[C]{\thepage / \pageref{LastPage}}
\renewcommand{\footrulewidth}{0.5pt}
\renewcommand{\headrulewidth}{0.5pt}
\setlength{\parindent}{0pt} 
\setlength{\headheight}{0pt}

\author{Tutor: Ansgar Schneider}
\date{}
\title{Max Wisniewski , Alexander Steen}

\begin{document}

\lstset{language=Pascal, basicstyle=\ttfamily\fontsize{10pt}{10pt}\selectfont\upshape, commentstyle=\rmfamily\slshape, keywordstyle=\rmfamily\bfseries, breaklines=true, frame=single, xleftmargin=3mm, xrightmargin=3mm, tabsize=2}

\maketitle
\thispagestyle{fancy}


%% ------------------------------------------------------
%%                     AUFGABE 1
%% ------------------------------------------------------

\section*{Aufgabe 1}
Definieren Sie die WSKEA-Maschine derart um, dass bei arithmetischen Ausdrücken rechte Unterausdrücke vor linken ausgewertet werden. Konstruieren Sie ein Beispiel, für das ein abweichendes Ergebnis erzielt wird. \\

\textbf{Lösung:}

Dafür müssen lediglich zwei Zustandübergänge geändert werden, der Rest kann gleich bleiben:

(i) Zuerst müssen die rechten Ausdrücke einer Operation zuerst auf den Keller gelegt werden, damit diese zuerst ausgewertet werden: \\

$ \Delta<W | S | T_1 \underline{OP} T_2.K | E | A> :=
        <W | S | T_2.T_1.\underline{OP}.K | E | A>$ \\

(ii) Dann müssen wir beim Herunternehmen der Ergebnisse die korrekte der Operationsanwendung wieder herstellen:\\

$ \Delta<n_1.n_2.W | S | +.K | E | A> :=
        <n_1+n_2.W | S | K | E | A>$, falls $n_1+n_2$ darstellbar.\\

Diese Regel kann analog auf alle anderen arithmetische Operationen angewendet werden.

\textbf{Abweichendes Beispiel:}\\
\begin{description}
	\item{\bfseries Links-vor-Rechts:} 

$$
\begin{array}{rcl}
\Delta<()|()| \underline{read} - \underline{read} | (3,2) | A> &:=& \Delta<()|()| \underline{read}, \underline{read} , -| (3,2) | A>\\
	&:=& \Delta<(3)|()|\underline{read}, - | (2) | A>\\
	&:=& \Delta<(2,3)|()| - | () | A>\\
	&:=& \Delta<(3-2)|()| - | () | A>\\
\end{array}
$$

	\item{\bfseries Rechts-vor-Links:}

$$
\begin{array}{rcl}
\Delta<()|()| \underline{read} - \underline{read} | (3,2) | A> &:=& \Delta<()|()| \underline{read}, \underline{read} , -| (3,2) | A>\\
	&:=& \Delta<(3)|()|\underline{read}, - | (2) | A>\\
	&:=& \Delta<(2,3)|()| - | () | A>\\
	&:=& \Delta<(2-3)|()| - | () | A>\\
\end{array}
$$

Im ersten Fall wird im linken Ausdruck die $3$ zuerst gelesen und im rechten die $2$. Wir rechnen vollglich $3-2$ und erhalten eine $1$.
Im zweitenn Fall gehen wir erst in den rechten Ausdruck, lesen dort die $3$ und gehen danach in den linken zweig und lesen dort als nächstes die $2$. Wir rechnen also $2-3$ und erhalten eine $-1$.

\end{description}


%% ------------------------------------------------------
%%                     AUFGABE 2
%% ------------------------------------------------------

\section*{Aufgabe 2}
Erweitern Sie die WSKEA-Maschine um eine Komponente \texttt{N} für Nachrichten (Texte), in der kurze sinnvolle Meldungen eingetragen werden, wenn es keinen Folgezustand gibt oder wenn die Ausführung korrekt terminiert.\\

\textbf{Lösung:}\\

Wir erweitern Zunächst unseren Zustand $z$ um eine Nachricht. Da wir nur Nachrichten zurückgeben, wenn wir abstürzen oder fertig sind, brauchen wir keinen Stack und keine Queue. Es muss einfach ein Text gespeichert werden.
$<W | S | K | E | A | N >$, dabei sind $W,S,L,E,A$ wie in der ursprünglichen WSKEA Maschine und $N$ ist das eben erwähnt Feld für die einzelne Nachricht. Der Startzustand $z_{P,E} = < \varepsilon | S_0 | P.\varepsilon | E | \varepsilon | \varepsilon >$ ist äquivalent zum ursprünglichen Startzustand. Der letzte Eintrag für die Nachricht $N$ ist einfach leer. Da wir nun auch im Fehlerfall eine Überführung haben wollen und nicht einfach abbrechen, definieren wir eine Funktion, die die unendliche Ausführung ermöglicht und bei Beendigung Idempotent sein sollte:
$$
\Delta < W | S | K | E | A | n > = <W | S | K | E | A | n >, \quad \text{für }n \not= \varepsilon
$$
Dies bedeutet, sollten wir eine Nachricht empfangen haben, lassen wir den Zustand unverändert, da es sich um einen Fehler handelt oder das Programm schon fertig ist. Damit wir nicht so viel schreiben müssen übernehmen wir alle anderen Überführungsfunktionen, wie gehabt, wenn die nachricht $\varepsilon$ ist. Nun müssen wir nur noch Fälle betrachten in denen das Programm beendet wird oder ein Fehler auftritt.
$$
\Delta < W | S | \varepsilon | E | A | \varepsilon> = < W | S | \varepsilon | E | A | \text{ Programm erfolgreich beendet }>
$$
Einen Fehler können vielfällitg auftreten, wie wir auf dem ersten Übungsblatt gesehen haben, wir werden es hier exemplarisch für \emph{IF} und \emph{+} zeigen
$$
\Delta <n1.n2.W | S | +.K | E | A | \varepsilon > = < W | S | K | E | A | \text{falsche Typ bei +} >, \quad n1,n2\text{ keine Zahl}
$$
$$
\Delta <n1.\varepsilon | S | +.K | E | A | \varepsilon> = < W | S | K | E | A |\text{Zu wenig Zahlen für +}>
$$
$$
\Delta <b.W | S | if.p1.p2.K | E | A | \varepsilon > = < W | S | K | E | A |\text{Bedingung ist keine Zahl}>, \quad b\text{ kein Bool}
$$

% -----------------------------------------------------------
%			AUFGABE 3
% -----------------------------------------------------------
\section*{Aufgabe 3}
Die Syntax von WHILE sei um das repeat-until-Konstrukt erweitert, wie in der Aufgabe. Ergänzen Sie die operationelle Semantik.\\

\textbf{Lösung:}\\

Die übliche Semantik von REPEAT C UNTIL B ist, dass man C solange ausführt, wie B gilt. Der unterschied zu While ist, dass man C zunächst einmal ausführt, bevor man die Bedingung prüft. Um es un leicht zu machen, formen wir REPEAT deshalb auf WHILE um. Die Berechnung wird dadurch nicht verändert.

$$
\Delta < W | S | \underline{REPEAT}\, C \, \underline{UNTIL}\, B . K | E | A> = <W | S | C . \underline{WHILE} \, \underline{NOT} \, (B)\,  \underline{DO} \, C \, \underline{OD} . K | E | A >
$$

Nach dieser Umformung wird zunächst einmal C ausgeführt. Nach dieser Ausführung wird B geprüft. Ist es wahr, wird die Schleife abgebrochen. Wenn nicht geht es in einen neuen Durchlauf über.

% -----------------------------------------------------------
%			AUFGABE 4
% -----------------------------------------------------------
\section*{Aufgabe 4}

tba

\label{LastPage}

\end{document}
